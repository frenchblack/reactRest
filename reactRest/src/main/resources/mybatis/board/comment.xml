<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.react.mapper.board.CommentMapper">
	<select id="getCommentList" resultType="CommentVO"> 
		SELECT A.COMMENT_NO AS COMMENT_NO
		     , A.BOARD_NO AS BOARD_NO
		     , A.USER_ID AS USER_ID
		     , B.USER_NM AS USER_NM
		     , A.COMMENT_CONTENT AS COMMENT_CONTENT
		     , A.WRITE_DATE AS WRITE_DATE
		     , A.EX_DEL AS EX_DEL
		     , A.LIKE_CNT AS LIKE_CNT
		     , A.COMMENT_LVL AS COMMENT_LVL
		     , ( SELECT COUNT(1)
				   FROM comment C
				  WHERE C.P_COMMENT_NO = A.COMMENT_NO
				    AND C.EX_DEL = 0) AS C_COMMENT_CNT
		  FROM comment A
		 INNER JOIN users B
		    ON A.USER_ID = B.USER_ID
		 WHERE A.EX_DEL = 0
		   AND A.COMMENT_LVL = 0
		   AND A.BOARD_NO = #{board_no}
		 ORDER BY A.WRITE_DATE
		        , A.COMMENT_NO
	</select>
</mapper>
